<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>知识库</title>
    <meta name="description" content="知识库">
    <meta name="generator" content="VitePress v2.0.0-alpha.12">
    <link rel="preload stylesheet" href="/myKMS/assets/style.y31ZBR2r.css" as="style">
    <link rel="preload stylesheet" href="/myKMS/vp-icons.css" as="style">
    
    <script type="module" src="/myKMS/assets/app.B5mT9e_X.js"></script>
    <link rel="preload" href="/myKMS/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/myKMS/assets/chunks/theme.BceQxUf_.js">
    <link rel="modulepreload" href="/myKMS/assets/chunks/framework.L9hZw9cv.js">
    <link rel="modulepreload" href="/myKMS/assets/knowledge_browser_http.md.fm7FRw8x.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body><!--teleport start anchor--><!----><!--teleport anchor-->
    <div id="app"><div class="Layout" data-v-304c8b69><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-304c8b69 data-v-d5bf7c8e><div class="VPNavBar" data-v-d5bf7c8e data-v-8eab0e6d><div class="wrapper" data-v-8eab0e6d><div class="container" data-v-8eab0e6d><div class="title" data-v-8eab0e6d><div class="VPNavBarTitle has-sidebar" data-v-8eab0e6d data-v-d4488dd0><a class="title" href="/myKMS/" data-v-d4488dd0><!--[--><!--]--><!----><span data-v-d4488dd0>知识库</span><!--[--><!--]--></a></div></div><div class="content" data-v-8eab0e6d><div class="content-body" data-v-8eab0e6d><!--[--><!--[--><!--[--><div class="random-question random-question--nav" data-v-4e1b7e9a><button type="button" class="random-question__trigger random-question__trigger--nav" data-v-4e1b7e9a> 🎯 随机一题 </button><!--teleport start--><!--teleport end--></div><!--]--><!--]--><!--]--><div class="VPNavBarSearch search" data-v-8eab0e6d><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-8eab0e6d data-v-020be4db><span id="main-nav-aria-label" class="visually-hidden" data-v-020be4db> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/myKMS/" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/myKMS/interview/code.html" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>面试</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/myKMS/knowledge/framework/react.html" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>框架</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/myKMS/knowledge/browser/http.html" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>浏览器</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-8eab0e6d data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-8eab0e6d data-v-ef6192dc data-v-a1a7286e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/xingyuanlong/myKMS" aria-label="github" target="_blank" rel="me noopener" data-v-a1a7286e data-v-32d78712><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-8eab0e6d data-v-f953d92f data-v-d8fae6e2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-d8fae6e2><span class="vpi-more-horizontal icon" data-v-d8fae6e2></span></button><div class="menu" data-v-d8fae6e2><div class="VPMenu" data-v-d8fae6e2 data-v-fcd1d7a8><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-a1a7286e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/xingyuanlong/myKMS" aria-label="github" target="_blank" rel="me noopener" data-v-a1a7286e data-v-32d78712><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-8eab0e6d data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-8eab0e6d><div class="divider-line" data-v-8eab0e6d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-304c8b69 data-v-5ae341c6><div class="container" data-v-5ae341c6><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-5ae341c6><span class="vpi-align-left menu-icon" data-v-5ae341c6></span><span class="menu-text" data-v-5ae341c6>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-5ae341c6 data-v-e28a51a6><button data-v-e28a51a6>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-304c8b69 data-v-e0eef791><div class="curtain" data-v-e0eef791></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-e0eef791><span class="visually-hidden" id="sidebar-aria-label" data-v-e0eef791> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>基础知识</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/base/js.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>js</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/base/nodejs.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>node</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/base/css.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>css</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>interview</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/interview/2025.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>2025</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/interview/code.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>code</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/interview/index.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>开放性问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>框架</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/framework/react.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>react</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/framework/vue.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>vue</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/framework/vite.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>工程化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/framework/electron.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>electron</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 has-active" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>浏览器</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/browser/index.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>browser</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/browser/http.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>http</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/knowledge/browser/webSecurity.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>web安全</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>读书笔记</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/book/vue_1.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>vue.js 设计与实践</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>算法</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/algorithm/index.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>总</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>AI</h2><!----></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/myKMS/ai/index.html" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ai</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-304c8b69 data-v-2652e39a><div class="VPDoc has-sidebar has-aside" data-v-2652e39a data-v-d668f7cc><!--[--><!--]--><div class="container" data-v-d668f7cc><div class="aside" data-v-d668f7cc><div class="aside-curtain" data-v-d668f7cc></div><div class="aside-container" data-v-d668f7cc><div class="aside-content" data-v-d668f7cc><div class="VPDocAside" data-v-d668f7cc data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-c8b19031><div class="content" data-v-c8b19031><div class="outline-marker" data-v-c8b19031></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c8b19031>页面导航</div><ul class="VPDocOutlineItem root" data-v-c8b19031 data-v-b7d7ef80><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d668f7cc><div class="content-container" data-v-d668f7cc><!--[--><!--]--><main class="main" data-v-d668f7cc><div style="position:relative;" class="vp-doc _myKMS_knowledge_browser_http" data-v-d668f7cc><div><h3 id="_1-http2的首部压缩" tabindex="-1">1. http2的首部压缩 <a class="header-anchor" href="#_1-http2的首部压缩" aria-label="Permalink to “1. http2的首部压缩”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><ul><li><p>为什么要压缩首部？</p><ul><li>HTTP/1.1 的每个请求都会携带大量重复的首部. 这些头部在同一个连接中 几乎每次都一样，比如 User-Agent、Cookie、Accept。HTTP/2 引入 首部压缩（Header Compression） 来减少这种重复，提高传输效率。</li></ul></li><li><p>HTTP/2 首部压缩机制：HPACK</p></li></ul><table tabindex="0"><thead><tr><th>机制</th><th>说明</th></tr></thead><tbody><tr><td><strong>静态表（Static Table）</strong></td><td>内置常见头部字段，如 <code>:method</code>, <code>:path</code>, <code>:status</code> 等；用索引代替字符串。</td></tr><tr><td><strong>动态表（Dynamic Table）</strong></td><td>在连接中缓存已发送的头部；后续请求只需引用索引。</td></tr><tr><td><strong>霍夫曼编码（Huffman Encoding）</strong></td><td>对字符串部分再进行霍夫曼编码，进一步压缩体积。</td></tr></tbody></table><ul><li>HPACK 的压缩原理图</li></ul><table tabindex="0"><thead><tr><th>步骤</th><th>动作</th><th>效果</th></tr></thead><tbody><tr><td>1</td><td>查静态表</td><td>常用字段直接用编号（如 <code>:method: GET</code> = #2）</td></tr><tr><td>2</td><td>查动态表</td><td>最近请求过的头字段从表中引用</td></tr><tr><td>3</td><td>发送差异数据</td><td>只发送新字段或变化部分</td></tr><tr><td>4</td><td>霍夫曼编码</td><td>对字符串再压缩</td></tr><tr><td>✅</td><td>结果</td><td>头部数据量可减少 60–90%</td></tr></tbody></table><p><strong>HTTP/2 的首部压缩机制（HPACK）通过静态表、动态表和霍夫曼编码三种方式，实现头部字段的高效压缩与重用，大幅减少网络传输开销。</strong></p><p>HTTP/2 是一个二进制协议。在 HTTP/1.1 版中，报文的头信息必须是文本（ASCII 编码），数据体可以是文本，也可以是二进制。HTTP/2 则是一个彻底的二进制协议，头信息和数据体都是二进制，并且统称为&quot;帧&quot;，可以分为头信息帧和数据帧。 帧的概念是它实现多路复用的基础。</p><!--]--></div></div><h3 id="_2-tcp-断开4次挥手" tabindex="-1">2. tcp 断开4次挥手 <a class="header-anchor" href="#_2-tcp-断开4次挥手" aria-label="Permalink to “2. tcp 断开4次挥手”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>TCP 是全双工的. 全双工（Full-duplex）：</p><ul><li>即双方可以同时发送和接收数据。</li><li>所以连接断开时，双方都要单独关闭各自的发送方向。</li></ul><p>假设：客户端（主动关闭连接）服务器（被动关闭连接）</p><p>通信结束时，断开过程如下：</p><table tabindex="0"><thead><tr><th>步骤</th><th>方向</th><th>报文标志位</th><th>说明</th></tr></thead><tbody><tr><td>①</td><td>客户端 → 服务器</td><td><code>FIN=1</code></td><td>客户端请求关闭发送通道</td></tr><tr><td>②</td><td>服务器 → 客户端</td><td><code>ACK=1</code></td><td>服务器确认接收</td></tr><tr><td>③</td><td>服务器 → 客户端</td><td><code>FIN=1</code></td><td>服务器也关闭发送通道</td></tr><tr><td>④</td><td>客户端 → 服务器</td><td><code>ACK=1</code></td><td>客户端确认接收，进入 TIME_WAIT</td></tr></tbody></table><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>客户端 (Client)                             服务器 (Server)</span></span>
<span class="line"><span>------------------                          ------------------</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   ESTABLISHED                                  ESTABLISHED</span></span>
<span class="line"><span>        |                                              |</span></span>
<span class="line"><span>        | ① FIN=1, seq=u                              |</span></span>
<span class="line"><span>        |---------------------------------------------&gt;|</span></span>
<span class="line"><span>        |                                              |</span></span>
<span class="line"><span>        |                           收到 FIN, 发 ACK=1, ack=u+1</span></span>
<span class="line"><span>        | ②                                            |</span></span>
<span class="line"><span>        |&lt;---------------------------------------------|</span></span>
<span class="line"><span>        |                                              |</span></span>
<span class="line"><span>        |                           服务器继续处理剩余数据</span></span>
<span class="line"><span>        |                                              |</span></span>
<span class="line"><span>        |                           ③ FIN=1, seq=v    |</span></span>
<span class="line"><span>        |&lt;---------------------------------------------|</span></span>
<span class="line"><span>        | ④ ACK=1, ack=v+1                             |</span></span>
<span class="line"><span>        |---------------------------------------------&gt;|</span></span>
<span class="line"><span>        |                                              |</span></span>
<span class="line"><span>   TIME_WAIT(等待2MSL)                          CLOSED</span></span>
<span class="line"><span>        |</span></span>
<span class="line"><span>   连接彻底关闭</span></span></code></pre></div><p>客户端最后要 等待 2×MSL（Maximum Segment Lifetime） 时间，约几十秒。</p><p>作用：</p><ul><li><p>确保服务器收到最终 ACK</p><ul><li>若 ACK 丢失，服务器会重发 FIN。</li><li>客户端在 TIME_WAIT 状态还能重发 ACK。</li></ul></li><li><p>防止旧连接残余报文影响新连接</p><ul><li>等待 MSL 确保网络中旧包都过期。</li></ul></li></ul><ol><li>为什么关闭要四次，而不是三次？ 因为 TCP 是全双工：</li></ol><ul><li>一方关闭发送，不代表另一方也关闭；</li><li>必须双方都各自发送 FIN，确认关闭。</li></ul><ol start="2"><li>为什么客户端要 TIME_WAIT？</li></ol><p>防止最后的 ACK 丢失，确保连接彻底关闭。 另外，避免旧连接的数据干扰新连接。</p><ol start="3"><li>为什么是 “2MSL”？</li></ol><p>因为： 一个 MSL 是一个报文在网络中能存活的最长时间； 等 2×MSL，确保往返的所有旧报文都消失。</p><ol start="4"><li>如果服务器先关闭会怎样？</li></ol><p>流程相同，只是角色对调。 谁主动关闭，谁就经历 TIME_WAIT。</p><!--]--></div></div><h3 id="_3-什么是队头阻塞" tabindex="-1">3. 什么是队头阻塞 <a class="header-anchor" href="#_3-什么是队头阻塞" aria-label="Permalink to “3. 什么是队头阻塞”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>队头阻塞就是“队列第一个请求卡住，后面全被拖延”。HTTP/3 通过 QUIC 彻底缓解了这个问题。</p><!--]--></div></div><h3 id="_4-http-2-多路复用" tabindex="-1">4. http 2 多路复用 <a class="header-anchor" href="#_4-http-2-多路复用" aria-label="Permalink to “4. http 2 多路复用”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>HTTP/1.1 每个请求都必须建立在一个 TCP 连接上。虽然它支持“Keep-Alive”长连接，但仍然有两个性能瓶颈：</p><ul><li>队头阻塞（Head-of-Line Blocking）: 一个连接中，请求是串行执行的。前一个响应没回来，后面的请求必须等。</li><li>多连接并发受限: 浏览器为同一域名通常只能同时开 6 个 TCP 连接，多了也被限制。</li><li>📦 头部重复传输: 每次请求都要携带大量相同的 Header（如 cookie、user-agent）。</li></ul><p>在一个 TCP 连接上，同时并发多个 HTTP 请求与响应。</p><p>工作方式：</p><ol><li>所有请求和响应都被拆分成小块（frame）。</li><li>每个请求分配一个唯一的 Stream ID。</li><li>这些 frame 被交错（交织）发送，在同一个 TCP 连接中同时传输。</li><li>接收端再根据 Stream ID 把它们拼回原样。</li></ol><p>举个例子： 假设浏览器要加载三个资源：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>index.html</span></span>
<span class="line"><span>style.css</span></span>
<span class="line"><span>main.js</span></span></code></pre></div><p>HTTP/1.1：</p><ul><li>3 个请求需要占用 3 个 TCP 连接；</li><li>或者 1 个连接按顺序：html → css → js；</li><li>前面的慢了，后面的全卡住（队头阻塞）。</li></ul><p>HTTP/2：</p><ul><li>所有请求共用 1 个 TCP 连接；</li><li>三个请求的 frame 被交错发送；</li><li>谁先返回数据就先解析，完全并行。</li></ul><p>多路复用消除了 HTTP 层阻塞，但 TCP 层仍可能受丢包影响。</p><p><strong>HTTP/2 多路复用 = 一个连接里同时传多条请求流，互不阻塞，性能飞升。</strong></p><!--]--></div></div><h3 id="_5-dns-协议" tabindex="-1">5. DNS 协议 <a class="header-anchor" href="#_5-dns-协议" aria-label="Permalink to “5. DNS 协议”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>DNS（Domain Name System） 是一个将 域名 ↔ IP 地址 相互映射的分布式系统。</p><p>因为：用户容易记住 www.example.com;计算机只能识别 93.184.216.34;DNS 让我们可以使用域名访问网站，系统自动帮你找到正确的 IP。</p><p>DNS 解析的完整流程:</p><ul><li>浏览器缓存: 先查本地 DNS 缓存（比如上次访问过)</li><li>操作系统缓存: 如果浏览器里没有，就问操作系统的 DNS 缓存。</li><li>hosts 文件: 操作系统先查 hosts 文件，看看是否有手动配置。</li><li>本地 DNS 服务器（递归解析器）: 一般由 ISP（网络运营商）提供，比如 8.8.8.8（Google）、114.114.114.114（中国电信）。</li><li>递归查询（DNS 服务器帮你查到底）</li></ul><p>DNS 通常使用 UDP 53 端口（查询），TCP 用于传输大数据量（如区域传送）。</p><p>每条 DNS 记录都有一个 TTL（Time To Live） 值，比如 300 秒。</p><!--]--></div></div><h3 id="_6-html-script-defer-与async" tabindex="-1">6. html script defer 与async <a class="header-anchor" href="#_6-html-script-defer-与async" aria-label="Permalink to “6. html script defer 与async”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><table tabindex="0"><thead><tr><th>特性</th><th><code>&lt;script async&gt; </code></th><th><code>&lt;script defer&gt;</code></th></tr></thead><tbody><tr><td>加载时机 (Loading)</td><td>立即加载（与 HTML 解析并行）</td><td>立即加载（与 HTML 解析并行）</td></tr><tr><td>执行时机 (Execution)</td><td>文件下载完成后立即执行</td><td>等待整个 HTML 文档解析完成后再执行</td></tr><tr><td>执行顺序</td><td>不保证顺序。哪个文件先下载完，哪个先执行。</td><td>保证顺序。按在文档中出现的顺序依次执行。</td></tr><tr><td>是否阻塞 HTML</td><td>会。文件执行时会暂停 HTML 解析。</td><td>不会。保证在 HTML 解析完成后才执行。</td></tr><tr><td>适用场景</td><td>适用于独立脚本，不依赖 DOM，也不被其他脚本依赖（如统计脚本）。</td><td>适用于依赖 DOM 或被其他 defer 脚本依赖的脚本（如应用主逻辑脚本）。</td></tr></tbody></table><!--]--></div></div><h3 id="_7-http-3" tabindex="-1">7. HTTP/3 <a class="header-anchor" href="#_7-http-3" aria-label="Permalink to “7. HTTP/3”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p><strong>HTTP/3 = HTTP/2 + QUIC(UDP)</strong></p><p>HTTP/3 是继 HTTP/2 之后的下一代超文本传输协议。它的核心变化是：<strong>不再基于 TCP，而是基于 QUIC（UDP 之上的新协议）。</strong></p><table tabindex="0"><thead><tr><th>协议</th><th>传输层</th><th>特点</th><th>存在问题</th></tr></thead><tbody><tr><td><strong>HTTP/1.1</strong></td><td>TCP</td><td>简单、可靠</td><td>多连接、阻塞严重</td></tr><tr><td><strong>HTTP/2</strong></td><td>TCP</td><td>多路复用、头部压缩</td><td>TCP 队头阻塞无法彻底解决</td></tr><tr><td><strong>HTTP/3</strong></td><td><strong>UDP（QUIC）</strong></td><td>多路复用、内置加密、低延迟</td><td>部分老设备不兼容 UDP</td></tr></tbody></table><p>QUIC（UDP）的优势</p><p>QUIC 直接运行在 UDP 之上，自己实现可靠传输 + 拥塞控制 + 加密：</p><ul><li>消除队头阻塞：每个流独立传输，不互相影响</li><li>1-RTT 握手（甚至 0-RTT）</li><li>连接可迁移（基于 Connection ID）</li><li>内置 TLS 1.3 加密（强制 HTTPS）</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// HTTP/2</span></span>
<span class="line"><span>HTTP/2</span></span>
<span class="line"><span>  ↓</span></span>
<span class="line"><span>  TLS</span></span>
<span class="line"><span>  ↓</span></span>
<span class="line"><span>  TCP</span></span>
<span class="line"><span>  ↓</span></span>
<span class="line"><span>  IP</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// HTTP/3</span></span>
<span class="line"><span>HTTP/3</span></span>
<span class="line"><span>  ↓</span></span>
<span class="line"><span>  QUIC (内含TLS 1.3 + 可靠传输)</span></span>
<span class="line"><span>  ↓</span></span>
<span class="line"><span>  UDP</span></span>
<span class="line"><span>  ↓</span></span>
<span class="line"><span>  IP</span></span></code></pre></div><!--]--></div></div><h3 id="_8-nginx-proxy-pass-与location-结尾加不加-对路径的影响" tabindex="-1">8. nginx proxy_pass 与location 结尾加不加 / 对路径的影响 <a class="header-anchor" href="#_8-nginx-proxy-pass-与location-结尾加不加-对路径的影响" aria-label="Permalink to “8. nginx proxy_pass 与location 结尾加不加 / 对路径的影响”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p><strong>尾斜杠“决定路径拼接规则”</strong> ,location 和 proxy_pass 的结尾 是否带 /，直接决定了 Nginx 如何拼接请求路径。</p><p>proxy_pass 加不加 /:</p><ul><li>不加 /：location 匹配的路径会被完整拼接到 proxy_pass 地址后（适合后端接口路径与前端请求路径完全一致的场景）。</li><li>加 /：location 匹配的路径会被替换为 /，仅将剩余路径拼接到 proxy_pass 地址后（适合需要简化后端接口路径的场景）。</li></ul><p>参考:</p><table tabindex="0"><thead><tr><th style="text-align:center;">情形</th><th style="text-align:left;"><code>location</code> 配置</th><th style="text-align:left;"><code>proxy_pass</code> 配置</th><th style="text-align:left;">请求示例</th><th style="text-align:left;">转发给上游的路径</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:left;"><code>/api</code>（不带斜杠）</td><td style="text-align:left;"><code>http://backend</code>（不带斜杠）</td><td style="text-align:left;"><code>/api/foo</code></td><td style="text-align:left;"><code>http://backend/api/foo</code></td><td style="text-align:left;">保留原始路径 <code>/api/foo</code>。</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:left;"><code>/api</code>（不带斜杠）</td><td style="text-align:left;"><code>http://backend/</code>（带斜杠）</td><td style="text-align:left;"><code>/api/foo</code></td><td style="text-align:left;"><code>http://backend//foo</code></td><td style="text-align:left;">去除 <code>/api</code> 前缀后拼接，产生双斜杠。</td></tr><tr><td style="text-align:center;">3</td><td style="text-align:left;"><code>/api/</code>（带斜杠）</td><td style="text-align:left;"><code>http://backend</code>（不带斜杠）</td><td style="text-align:left;"><code>/api/foo</code></td><td style="text-align:left;"><code>http://backend/api/foo</code></td><td style="text-align:left;">保留 <code>/api/</code> 前缀。</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:left;"><code>/api/</code>（带斜杠）</td><td style="text-align:left;"><code>http://backend/</code>（带斜杠）</td><td style="text-align:left;"><code>/api/foo</code></td><td style="text-align:left;"><code>http://backend/foo</code></td><td style="text-align:left;">去除 <code>/api/</code> 前缀后拼接，结果 <code>/foo</code>。</td></tr></tbody></table><!--]--></div></div><h3 id="_9-nginx多域名隔离-同域名不同路径映射" tabindex="-1">9. nginx多域名隔离, 同域名不同路径映射 <a class="header-anchor" href="#_9-nginx多域名隔离-同域名不同路径映射" aria-label="Permalink to “9. nginx多域名隔离, 同域名不同路径映射”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>Nginx 可以通过 include 指令或虚拟主机（vhost）实现前端多环境（如开发、测试、生产）的隔离部署，同时针对同域名不同路径的映射场景，需要处理路径重写和资源引用问题</p><p>多环境隔离的核心是为不同环境（如 dev、test、prod）配置独立的 Nginx 规则，避免互相干扰。</p><ol><li>基于 include 指令的多环境配置（推荐）</li></ol><ul><li>适合单服务器部署多个环境，通过拆分配置文件实现隔离，便于维护。</li><li>也适合单服务部署多域名环境</li></ul><ol start="2"><li>基于虚拟主机（vhost）的多环境配置</li></ol><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 开发环境（域名区分）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dev.example.com;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 开发环境域名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/path/to/frontend/dev;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # ... 其他配置（路由、代理等）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 测试环境（端口区分）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8081</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试环境端口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localhost;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/path/to/frontend/test;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # ... 其他配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 生产环境（HTTPS）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ssl;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生产环境域名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/path/to/frontend/prod;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # ... SSL 配置和其他生产环境特有的规则</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>同域名不同路径映射的重写问题及解决方案</p><p>当多个前端应用部署在同一域名的不同路径下（如 example.com/app1、example.com/app2），需要解决路径映射和资源引用的问题。</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 父目录</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 应用 A：匹配 /app1 路径</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /app1 </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 实际文件目录为 /var/www/app1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        alias </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/app1;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 注意：这里用 alias 而非 root（关键区别）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 解决 History 路由刷新 404</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /app1/index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 应用 B：匹配 /app2 路径</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /app2 </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        alias </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/app2;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /app2/index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>关键区别：alias vs root</p><p>root /var/www：请求 /app1/static/css.css 会映射到 /var/www/app1/static/css.css（拼接完整路径）。 alias /var/www/app1：请求 /app1/static/css.css 会直接映射到 /var/www/app1/static/css.css（替换 /app1 为实际目录），更适合子路径部署。</p><!--]--></div></div><h3 id="_10-websocket" tabindex="-1">10. WebSocket <a class="header-anchor" href="#_10-websocket" aria-label="Permalink to “10. WebSocket”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>WebSocket是HTML5提供的一种浏览器与服务器进行全双工通讯的网络技术，属于应用层协议。它基于TCP传输协议，并复用HTTP的握手通道。浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接， 并进行双向数据传输。</p><p>WebSocket 的出现就解决了半双工通信的弊端。它最大的特点是：<strong>服务器可以向客户端主动推动消息，客户端也可以主动向服务器推送消息。</strong></p><p>WebSocket 特点的如下：</p><ul><li>支持双向通信，实时性更强</li><li>可以发送文本，也可以发送二进制数据‘’</li><li>建立在TCP协议之上，服务端的实现比较容易</li><li>数据格式比较轻量，性能开销小，通信高效</li><li>没有同源限制，客户端可以与任意服务器通信</li><li>协议标识符是ws（如果加密，则为wss），服务器网址就是 URL</li><li>与 HTTP 协议有着良好的兼容性。默认端口也是80和443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</li><li>连接通过 HTTP Upgrade 握手升级而来。</li></ul><!--]--></div></div><h3 id="_11-短轮询、长轮询、sse-和-websocket" tabindex="-1">11. 短轮询、长轮询、SSE 和 WebSocket <a class="header-anchor" href="#_11-短轮询、长轮询、sse-和-websocket" aria-label="Permalink to “11. 短轮询、长轮询、SSE 和 WebSocket”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><table tabindex="0"><thead><tr><th>特性</th><th>短轮询</th><th>长轮询</th><th>SSE</th><th>WebSocket</th></tr></thead><tbody><tr><td>协议</td><td>HTTP</td><td>HTTP</td><td>HTTP（text/event-stream）</td><td>专用 WS 协议（基于 TCP）</td></tr><tr><td>实时性</td><td>⏱ 延迟高</td><td>⚡ 中等</td><td>⚡ 高</td><td>🚀 最高</td></tr><tr><td>方向</td><td>客户端拉取</td><td>客户端拉取</td><td>服务端推送</td><td>双向</td></tr><tr><td>兼容性</td><td>✅ 最好</td><td>✅ 好</td><td>⚠️ IE 不支持</td><td>⚠️ 需服务器支持</td></tr><tr><td>连接数量</td><td>多</td><td>多（长时间挂起）</td><td>少（单连接）</td><td>少（持久连接）</td></tr><tr><td>复杂度</td><td>⭐ 简单</td><td>⭐⭐ 中等</td><td>⭐⭐ 中等</td><td>⭐⭐⭐ 高</td></tr><tr><td>常见场景</td><td>定时刷新数据</td><td>即时消息、通知</td><td>日志推送、股票行情</td><td>聊天、游戏、协同编辑</td></tr></tbody></table><table tabindex="0"><thead><tr><th>场景</th><th>推荐方式</th><th>理由</th></tr></thead><tbody><tr><td>定时刷新、后台任务</td><td>短轮询</td><td>简单可靠</td></tr><tr><td>实时通知、消息提醒</td><td>长轮询 / SSE</td><td>实时性高，易于部署</td></tr><tr><td>实时图表、日志流</td><td>SSE</td><td>单向推送、易实现</td></tr><tr><td>聊天、多人协作、游戏, 消息</td><td>WebSocket</td><td>双向实时通信能力强</td></tr></tbody></table><ul><li>短轮询: 每隔短时间询问服务器</li><li>长轮询: 浏览器发送请求后，服务器不立即返回，而是等到有新数据再响应，或者超时（例如 30s）。浏览器收到响应后立即发起下一次请求，保持“几乎实时”。</li><li>SSE: 服务器通过 HTTP 长连接 向浏览器“持续推送”数据（单向）。(&#39;Content-Type&#39;: &#39;text/event-stream&#39;)</li><li>WebSocket 是 全双工通信协议，一旦连接建立，客户端和服务器都可以主动发送消息。</li></ul><!--]--></div></div><h3 id="_11-tcp-和-udp" tabindex="-1">11. TCP 和 UDP <a class="header-anchor" href="#_11-tcp-和-udp" aria-label="Permalink to “11. TCP 和 UDP”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><table tabindex="0"><thead><tr><th>维度</th><th><strong>TCP</strong></th><th><strong>UDP</strong></th></tr></thead><tbody><tr><td>连接</td><td>面向连接（3 次握手、4 次挥手）</td><td>无连接</td></tr><tr><td>可靠性</td><td>可靠传输：确认、重传、顺序保证，流量/拥塞控制</td><td>尽力而为：无确认、无重传、可能乱序/丢包</td></tr><tr><td>有序性</td><td>严格有序</td><td>可能乱序</td></tr><tr><td>头部开销（不含 IP）</td><td>≥ 20 字节（可选项更多）</td><td>固定 8 字节</td></tr><tr><td>传输单位</td><td>流（byte stream），无消息边界</td><td>报文（datagram），保留应用层消息边界</td></tr><tr><td>拥塞/流控</td><td>有（拥塞控制、滑动窗口等）</td><td>无（需要应用层自管）</td></tr><tr><td>速度/时延</td><td>建连成本高，稳态吞吐好</td><td>首包快、时延低，适合短小消息与实时</td></tr><tr><td>广播/组播</td><td>不支持</td><td>支持（常见于局域网广播、IP 组播）</td></tr><tr><td>常见场景</td><td>Web(HTTP/1.1/2)、数据库、文件传输、邮件、SSH、TLS</td><td>实时音视频、游戏状态同步、DNS、DHCP、IoT、QUIC(底层用 UDP)</td></tr><tr><td>典型端口示例</td><td>80/443(HTTP/HTTPS)、22(SSH)</td><td>53(DNS)、123(NTP)、3478(STUN)</td></tr></tbody></table><p>优先 TCP：需要可靠、有序、简单开发的场景（Web、文件、DB、RPC 等）。</p><p>考虑 UDP：对时延敏感或丢少量包可接受、且希望自己掌控重传/拥塞策略的场景（音视频直播、实时互动、网游、物联网心跳/遥测、服务发现）。</p><p>跨公网实时 &amp; 传文件：优先 QUIC/HTTP3 或专业传输协议（兼顾低时延与可靠）</p><p>MTU/分片：UDP 单包上限理论 65,507 字节（IPv4），但易被分片丢弃；公网建议<strong>≤ 1200~1400 字节</strong>负载/包。</p><p>Nagle 与小包：TCP 默认可能启用 Nagle 算法，导致小包合并带来额外时延；可视场景 TCP_NODELAY。</p><p>粘包/拆包：TCP 是字节流，应用层必须自行定义消息边界（长度前缀/分隔符/帧协议）。UDP 天然有边界。</p><p>乱序/丢包补偿（UDP）：应用层可加序号、时间戳、FEC 或仅重传关键帧。</p><p>NAT 穿透：UDP 常配合 STUN/TURN/ICE；TCP 穿透更难。</p><p>组播/广播：局域网内服务发现（mDNS/SSDP）多用 UDP；公网路由对组播支持有限。</p><!--]--></div></div><h3 id="_12-osi-七层模型-tcp-ip-四层模型" tabindex="-1">12. OSI 七层模型 TCP/IP 四层模型 <a class="header-anchor" href="#_12-osi-七层模型-tcp-ip-四层模型" aria-label="Permalink to “12. OSI 七层模型 TCP/IP 四层模型”">​</a></h3><div class="vp-collapse" data-v-4585a904><div class="vp-collapse__summary" data-v-4585a904><!--[-->► 展开<!--]--></div><div class="vp-collapse__content" style="display:none;" data-v-4585a904><!--[--><p>OSI 七层模型总览:</p><table tabindex="0"><thead><tr><th>层号</th><th>层名（中文/英文）</th><th>典型协议/技术</th><th>常见设备</th><th>数据单元(PDU)</th><th>主要职责</th></tr></thead><tbody><tr><td>7</td><td>应用层 Application</td><td><strong>HTTP/HTTPS、DNS、SMTP、FTP、SSH、DHCP、SNMP</strong></td><td>应用服务器、DNS 服务器</td><td>数据(Data)</td><td>面向用户与应用，提供网络服务接口</td></tr><tr><td>6</td><td>表示层 Presentation</td><td>TLS/SSL、MIME、JPEG/MP3/JSON 编解码</td><td>—</td><td>数据(Data)</td><td>数据表示、加解密、压缩</td></tr><tr><td>5</td><td>会话层 Session</td><td>RPC、NetBIOS、gRPC 会话</td><td>—</td><td>数据(Data)</td><td>会话建立/维护/终止，状态管理</td></tr><tr><td>4</td><td>传输层 Transport</td><td><strong>TCP、UDP</strong>, QUIC（更接近4/7之间，实践常视为传输）</td><td>四层负载均衡器</td><td>段(Segment)/报文段</td><td>端到端可靠/不可靠传输，端口寻址</td></tr><tr><td>3</td><td>网络层 Network</td><td><strong>IP、ICMP、ARP</strong>*、IGMP、OSPF、BGP</td><td><strong>路由器</strong>、三层交换机</td><td>包(Packet)</td><td>逻辑寻址与路由转发</td></tr><tr><td>2</td><td>数据链路层 Data Link</td><td><strong>Ethernet(IEEE 802.3)、PPP、802.11 Wi-Fi</strong></td><td><strong>交换机</strong>、网卡</td><td>帧(Frame)</td><td>物理寻址(MAC)、成帧、差错检测</td></tr><tr><td>1</td><td>物理层 Physical</td><td>双绞线/光纤、USB、RJ-45、光模块</td><td><strong>中继器、集线器</strong></td><td>比特(Bit)</td><td>比特传输、电气/光学规范</td></tr></tbody></table><p>TCP/IP 四层模型:</p><table tabindex="0"><thead><tr><th>层号</th><th>层名（中文/英文）</th><th>典型协议/技术</th><th>常见设备</th><th>数据单元(PDU)</th><th>主要职责</th></tr></thead><tbody><tr><td>4</td><td>应用层 Application</td><td><strong>HTTP/HTTPS、DNS、SMTP、FTP、SSH、DHCP、SNMP、gRPC</strong></td><td>应用/反向代理、七层负载均衡</td><td>数据(Data)</td><td>应用服务与语义</td></tr><tr><td>3</td><td>传输层 Transport</td><td><strong>TCP、UDP、QUIC</strong></td><td>四层负载均衡</td><td>段/报文段</td><td>端到端传输与端口寻址</td></tr><tr><td>2</td><td>网际层 Internet</td><td><strong>IP、ICMP、IGMP</strong></td><td><strong>路由器</strong></td><td>包(Packet)</td><td>逻辑寻址与路由</td></tr><tr><td>1</td><td>网络接口层 Link/Network Access</td><td><strong>Ethernet、PPP、Wi-Fi、ARP</strong></td><td><strong>交换机、网卡</strong></td><td>帧/比特</td><td>物理传输与链路接入</td></tr></tbody></table><p>OSI ↔ TCP/IP 对照（HTTP 所在层）:</p><table tabindex="0"><thead><tr><th>OSI</th><th>TCP/IP</th><th>示例协议</th><th>说明</th></tr></thead><tbody><tr><td>7 应用层</td><td>4 应用层</td><td><strong>HTTP/HTTPS、DNS、SMTP</strong></td><td>HTTP 属于应用层</td></tr><tr><td>6 表示层</td><td>4 应用层</td><td>TLS/SSL、编码格式</td><td>在 TCP/IP 中并入应用层</td></tr><tr><td>5 会话层</td><td>4 应用层</td><td>会话/状态</td><td>在 TCP/IP 中并入应用层</td></tr><tr><td>4 传输层</td><td>3 传输层</td><td><strong>TCP、UDP、QUIC</strong></td><td>端到端传输</td></tr><tr><td>3 网络层</td><td>2 网际层</td><td><strong>IP、ICMP</strong></td><td>路由与寻址</td></tr><tr><td>2 数据链路层</td><td>1 网络接口层</td><td>Ethernet、Wi-Fi、ARP</td><td>局域网/链路接入</td></tr><tr><td>1 物理层</td><td>1 网络接口层</td><td>物理介质</td><td>比特流传输</td></tr></tbody></table><!--]--></div></div><h3 id="其他" tabindex="-1">其他 <a class="header-anchor" href="#其他" aria-label="Permalink to “其他”">​</a></h3><ul><li><p>HTTP/1.1</p><ul><li>特点: 持久连接 (Keep-Alive);管道化 (Pipelining);多连接并发;头部冗余;</li><li>问题: 队头阻塞、连接利用率低、头部冗余。</li></ul></li><li><p>HTTP2</p><ul><li>特点: 二进制分帧 (Binary Framing);多路复用 (Multiplexing);头部压缩 (HPACK);服务端推送 (Server Push);</li><li>改进点：减少延迟、提升带宽利用率。</li><li>问题: 因为仍然基于 TCP，丢包时所有流都要等，TCP 层仍然存在 队头阻塞</li></ul></li><li><p>HTTP/3</p><ul><li>特点: 基于 QUIC 协议（UDP 上实现）;内置 TLS 1.3 加密;更快的连接建立;多路复用天然支持;</li></ul></li><li><p>TLS/SSL: 加密（防止窃听）;身份认证（确认服务端身份）;完整性校验（防止篡改）</p></li><li><p>HTTPS 是在 HTTP 与 TCP 之间加入了TLS/SSL层，保证了通信的安全性。它通过数字证书验证服务器身份，用非对称加密实现安全的密钥交换，然后使用对称加密进行高效的数据传输。TLS 1.3 相比 TLS 1.2，减少了握手延迟并提升了安全性。</p></li><li><p>TLS 握手过程: ClientHello(浏览器发起握手，请求支持的加密算法、随机数), ServerHello(服务器选择加密算法，返回随机数和 数字证书（包含公钥）),验证证书(浏览器验证证书是否可信（CA 签发、域名匹配、未过期）), 密钥交换(浏览器用服务器公钥加密一个“对称会话密钥”，发给服务器。服务器用私钥解密，拿到对称密钥。), 建立安全通信(后续通信用对称加密（如 AES, ECC），保证性能)</p></li><li><p>TCP 特点: 传输控制协议：面向连接的，可靠的，基于字节流的传输层通信协议.(基于连接的,字节流,流量缓冲,可靠的传输服务,拥塞控制)</p></li><li><p>SYN: 握手, ACK 应答, FIN 断开</p></li></ul></div></div></main><footer class="VPDocFooter" data-v-d668f7cc data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/myKMS/knowledge/browser/index.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>browser</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/myKMS/knowledge/browser/webSecurity.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>web安全</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai_index.md\":\"Bf0m5gM2\",\"algorithm_index.md\":\"Djk1iw4J\",\"api-examples.md\":\"DT6A4-_P\",\"book_vue_1.md\":\"D9jihhfd\",\"index.md\":\"2ru8Ebp6\",\"interview_2025.md\":\"KfzA0qoa\",\"interview_code.md\":\"ColE19_b\",\"interview_index.md\":\"DCJEcbIP\",\"knowledge_base_app.md\":\"B-og-tQg\",\"knowledge_base_css.md\":\"QNGXhZBk\",\"knowledge_base_js.md\":\"BKGHn9LP\",\"knowledge_base_nodejs.md\":\"B2Ragjo6\",\"knowledge_browser_http.md\":\"fm7FRw8x\",\"knowledge_browser_index.md\":\"bflL4FMa\",\"knowledge_browser_websecurity.md\":\"DAtXeUcq\",\"knowledge_framework_angular.md\":\"Cj17XPWY\",\"knowledge_framework_app.md\":\"BB41ome5\",\"knowledge_framework_electron.md\":\"CM1OeWvB\",\"knowledge_framework_react.md\":\"tSjM_9wx\",\"knowledge_framework_taro.md\":\"JyVpdrlk\",\"knowledge_framework_vite.md\":\"CRPDAHSI\",\"knowledge_framework_vue.md\":\"CoZvO_xh\",\"knowledge_framework_wx.md\":\"DHlb7cxh\",\"readme.md\":\"Dvz-XUcs\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"知识库\",\"description\":\"知识库\",\"base\":\"/myKMS/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"面试\",\"link\":\"/interview/code\"},{\"text\":\"框架\",\"link\":\"/knowledge/framework/react\"},{\"text\":\"浏览器\",\"link\":\"/knowledge/browser/http\"}],\"sidebar\":[{\"text\":\"基础知识\",\"items\":[{\"text\":\"js\",\"link\":\"/knowledge/base/js\"},{\"text\":\"node\",\"link\":\"/knowledge/base/nodejs\"},{\"text\":\"css\",\"link\":\"/knowledge/base/css\"}]},{\"text\":\"interview\",\"items\":[{\"text\":\"2025\",\"link\":\"/interview/2025\"},{\"text\":\"code\",\"link\":\"/interview/code\"},{\"text\":\"开放性问题\",\"link\":\"/interview/index\"}]},{\"text\":\"框架\",\"items\":[{\"text\":\"react\",\"link\":\"/knowledge/framework/react\"},{\"text\":\"vue\",\"link\":\"/knowledge/framework/vue\"},{\"text\":\"工程化\",\"link\":\"/knowledge/framework/vite\"},{\"text\":\"electron\",\"link\":\"/knowledge/framework/electron\"}]},{\"text\":\"浏览器\",\"items\":[{\"text\":\"browser\",\"link\":\"/knowledge/browser/index\"},{\"text\":\"http\",\"link\":\"/knowledge/browser/http\"},{\"text\":\"web安全\",\"link\":\"/knowledge/browser/webSecurity\"}]},{\"text\":\"读书笔记\",\"items\":[{\"text\":\"vue.js 设计与实践\",\"link\":\"/book/vue_1\"}]},{\"text\":\"算法\",\"items\":[{\"text\":\"总\",\"link\":\"/algorithm/index\"}]},{\"text\":\"AI\",\"items\":[{\"text\":\"ai\",\"link\":\"/ai/index\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/xingyuanlong/myKMS\"}],\"outline\":{\"level\":[2,3],\"label\":\"页面导航\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>